# ğŸŒ HÆ¯á»šNG DáºªN TRá» DOMAIN Vá»€ VPS - CHI TIáº¾T Tá»ªNG BÆ¯á»šC

## ğŸ“‹ THÃ”NG TIN VPS Cá»¦A Báº N

- **IP VPS:** `103.157.204.120`
- **Website hiá»‡n táº¡i:** `http://103.157.204.120:8000`
- **Domain cáº§n trá»:** (vÃ­ dá»¥: `vtkt.online` hoáº·c domain cá»§a báº¡n)

---

## âš¡ QUICK START - ÄIá»€N GÃŒ VÃ€O TEN TEN.VN?

**Náº¿u báº¡n Ä‘ang á»Ÿ trang TenTen.vn vÃ  cáº§n Ä‘iá»n ngay:**

### **Báº£n ghi 1 - Domain chÃ­nh:**
- **TÃªn (Name):** `@`
- **Loáº¡i (Type):** `A`
- **GiÃ¡ trá»‹ (Value):** `103.157.204.120`
- **Äá»™ Æ°u tiÃªn (Priority):** `0` hoáº·c Ä‘á»ƒ trá»‘ng

### **Báº£n ghi 2 - Subdomain www:**
- **TÃªn (Name):** `www`
- **Loáº¡i (Type):** `A`
- **GiÃ¡ trá»‹ (Value):** `103.157.204.120`
- **Äá»™ Æ°u tiÃªn (Priority):** `0` hoáº·c Ä‘á»ƒ trá»‘ng

**Sau Ä‘Ã³ click "LÆ°u" (Save) vÃ  Ä‘á»£i 3-24 giá» Ä‘á»ƒ DNS cÃ³ hiá»‡u lá»±c!**

---

## ğŸ”§ BÆ¯á»šC 1: Cáº¤U HÃŒNH DNS Táº I NHÃ€ CUNG Cáº¤P DOMAIN

### **1.1. ÄÄƒng nháº­p vÃ o quáº£n lÃ½ domain**

- Truy cáº­p website cá»§a nhÃ  cung cáº¥p domain (vÃ­ dá»¥: TenTen.vn, Namecheap, GoDaddy, Cloudflare, v.v.)
- ÄÄƒng nháº­p vÃ o tÃ i khoáº£n
- VÃ o pháº§n quáº£n lÃ½ DNS/DNS Management

### **1.2. ThÃªm A Record**

#### **ğŸ“Œ Náº¿u báº¡n dÃ¹ng TenTen.vn (HÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c):**

1. **Truy cáº­p:** `https://domain.tenten.vn/ApiDnsSetting`
2. **TÃ¬m pháº§n "Record Ä‘ang sá»­ dá»¥ng"** (Records in use)
3. **Click nÃºt "ThÃªm"** (Add) - cÃ³ biá»ƒu tÆ°á»£ng dáº¥u + (mÃ u xanh)

4. **Äiá»n thÃ´ng tin vÃ o báº£ng (tá»«ng bÆ°á»›c cá»¥ thá»ƒ):**

   **BÆ°á»›c 4.1 - Chá»n Loáº¡i (Type):**
   - Click vÃ o dropdown "Loáº¡i" (hiá»‡n Ä‘ang hiá»ƒn thá»‹ "NS")
   - Trong danh sÃ¡ch dropdown, **chá»n "A"** (khÃ´ng chá»n NS, CNAME, MX...)
   - Dropdown sáº½ hiá»ƒn thá»‹: NS, **A**, CNAME, MX, TXT, REDIRECT, FRAME, SRV, AAAA, CAA, ALIAS, Page
   - âœ… **Chá»n "A"**
   
   **BÆ°á»›c 4.2 - Äiá»n TÃªn (Name):**
   - Click vÃ o Ã´ "TÃªn" (trÆ°á»ng text Ä‘áº§u tiÃªn)
   - GÃµ: `@`
   - âœ… **Káº¿t quáº£:** Ã” "TÃªn" cÃ³ giÃ¡ trá»‹ `@`
   
   **BÆ°á»›c 4.3 - Äiá»n GiÃ¡ trá»‹ (Value):**
   - Click vÃ o Ã´ "GiÃ¡ trá»‹" (trÆ°á»ng text thá»© 3)
   - GÃµ: `103.157.204.120`
   - âœ… **Káº¿t quáº£:** Ã” "GiÃ¡ trá»‹" cÃ³ IP VPS
   
   **BÆ°á»›c 4.4 - Äiá»n Äá»™ Æ°u tiÃªn (Priority):**
   - Click vÃ o Ã´ "Äá»™ Æ°u tiÃªn" (trÆ°á»ng text cuá»‘i)
   - GÃµ: `0` hoáº·c **Ä‘á»ƒ trá»‘ng** (cáº£ hai Ä‘á»u Ä‘Æ°á»£c)
   - âœ… **Káº¿t quáº£:** Ã” "Äá»™ Æ°u tiÃªn" cÃ³ giÃ¡ trá»‹ `0` hoáº·c trá»‘ng

5. **Click nÃºt "LÆ°u"** (Save) - nÃºt mÃ u xanh cÃ³ biá»ƒu tÆ°á»£ng Ä‘Ä©a ğŸ’¾
   - âœ… Báº£n ghi Ä‘áº§u tiÃªn Ä‘Ã£ Ä‘Æ°á»£c lÆ°u!

6. **ThÃªm báº£n ghi thá»© 2 cho www:**
   - Click nÃºt **"ThÃªm"** láº¡i
   - Láº·p láº¡i cÃ¡c bÆ°á»›c 4.1, 4.2, 4.3, 4.4
   - **KHÃC BIá»†T:** á» bÆ°á»›c 4.2, thay vÃ¬ gÃµ `@`, báº¡n gÃµ `www`
   - Click **"LÆ°u"**

7. **Äá»£i DNS cÃ³ hiá»‡u lá»±c:** 3-24 giá» (thÆ°á»ng lÃ  3 giá»)

**ğŸ“ TÃ³m táº¯t nhanh - Báº£n ghi 1:**
```
TÃªn: @
Loáº¡i: A (chá»n tá»« dropdown)
GiÃ¡ trá»‹: 103.157.204.120
Äá»™ Æ°u tiÃªn: 0
â†’ Click "LÆ°u"
```

**ğŸ“ TÃ³m táº¯t nhanh - Báº£n ghi 2:**
```
TÃªn: www
Loáº¡i: A (chá»n tá»« dropdown)
GiÃ¡ trá»‹: 103.157.204.120
Äá»™ Æ°u tiÃªn: 0
â†’ Click "LÆ°u"
```

**âš ï¸ LÆ°u Ã½ quan trá»ng:**
- **TÃªn `@`** = trá» domain chÃ­nh `vtkt.online`
- **TÃªn `www`** = trá» subdomain `www.vtkt.online`
- **Loáº¡i pháº£i lÃ  `A`** (khÃ´ng pháº£i CNAME, NS, MX...)
- **GiÃ¡ trá»‹ pháº£i lÃ  IP:** `103.157.204.120` (IP VPS cá»§a báº¡n)
- **Äá»™ Æ°u tiÃªn:** A record khÃ´ng cáº§n, Ä‘á»ƒ `0` hoáº·c trá»‘ng

#### **ğŸ“Œ Náº¿u báº¡n dÃ¹ng nhÃ  cung cáº¥p khÃ¡c:**

ThÃªm hoáº·c chá»‰nh sá»­a báº£n ghi **A Record** vá»›i thÃ´ng tin sau:

```
Type: A
Host: @ (hoáº·c Ä‘á»ƒ trá»‘ng, hoáº·c www)
Value/Points to: 103.157.204.120
TTL: 3600 (hoáº·c Auto)
```

**Giáº£i thÃ­ch:**
- **Host `@`**: Trá» domain chÃ­nh (vÃ­ dá»¥: `vtkt.online`)
- **Host `www`**: Trá» subdomain www (vÃ­ dá»¥: `www.vtkt.online`)
- **Value**: IP VPS cá»§a báº¡n (`103.157.204.120`)

**VÃ­ dá»¥ cáº¥u hÃ¬nh:**
```
A Record 1:
  Host: @
  Value: 103.157.204.120
  TTL: 3600

A Record 2:
  Host: www
  Value: 103.157.204.120
  TTL: 3600
```

### **1.3. LÆ°u cáº¥u hÃ¬nh**

- Click **Save** hoáº·c **Update**
- Äá»£i DNS propagate (thÆ°á»ng máº¥t 5 phÃºt - 48 giá», trung bÃ¬nh 1-2 giá»)

### **1.4. Kiá»ƒm tra DNS Ä‘Ã£ trá» chÆ°a**

Sá»­ dá»¥ng cÃ¡c cÃ´ng cá»¥ online:
- **https://dnschecker.org/** - Kiá»ƒm tra DNS toÃ n cáº§u
- **https://www.whatsmydns.net/** - Kiá»ƒm tra DNS
- **Command line:**
  ```bash
  # Windows
  nslookup vtkt.online
  
  # Linux/Mac
  dig vtkt.online
  # hoáº·c
  nslookup vtkt.online
  ```

**Káº¿t quáº£ mong Ä‘á»£i:** Tráº£ vá» IP `103.157.204.120`

---

## ğŸ”§ BÆ¯á»šC 2: Cáº¤U HÃŒNH APACHE TRÃŠN VPS

### **2.1. CÃ i Ä‘áº·t Apache (náº¿u chÆ°a cÃ³)**

```bash
# SSH vÃ o VPS
ssh root@103.157.204.120

# CÃ i Ä‘áº·t Apache
sudo apt update
sudo apt install -y apache2

# Kiá»ƒm tra Apache Ä‘Ã£ cÃ i
apache2 -v
```

### **2.2. KÃ­ch hoáº¡t cÃ¡c module cáº§n thiáº¿t**

```bash
# KÃ­ch hoáº¡t proxy modules
sudo a2enmod proxy
sudo a2enmod proxy_http
sudo a2enmod rewrite
sudo a2enmod headers

# Restart Apache
sudo systemctl restart apache2
```

### **2.3. Táº¡o Virtual Host cho domain**

```bash
# Táº¡o file cáº¥u hÃ¬nh virtual host
sudo nano /etc/apache2/sites-available/vtkt.online.conf
```

**Ná»™i dung file (thay `vtkt.online` báº±ng domain cá»§a báº¡n):**

```apache
<VirtualHost *:80>
    ServerName vtkt.online
    ServerAlias www.vtkt.online
    
    # Proxy táº¥t cáº£ request Ä‘áº¿n Docker container
    ProxyPreserveHost On
    ProxyPass / http://localhost:8000/
    ProxyPassReverse / http://localhost:8000/
    
    # Logs
    ErrorLog ${APACHE_LOG_DIR}/vtkt.online_error.log
    CustomLog ${APACHE_LOG_DIR}/vtkt.online_access.log combined
</VirtualHost>
```

**LÆ°u file:** `Ctrl + O`, Enter, `Ctrl + X`

### **2.4. KÃ­ch hoáº¡t Virtual Host**

```bash
# KÃ­ch hoáº¡t site
sudo a2ensite vtkt.online.conf

# VÃ´ hiá»‡u hÃ³a site máº·c Ä‘á»‹nh (náº¿u cáº§n)
sudo a2dissite 000-default.conf

# Kiá»ƒm tra cáº¥u hÃ¬nh Apache
sudo apache2ctl configtest

# Náº¿u OK, restart Apache
sudo systemctl restart apache2
```

### **2.5. Má»Ÿ firewall port 80 vÃ  443**

```bash
# Kiá»ƒm tra firewall
sudo ufw status

# Má»Ÿ port 80 (HTTP) vÃ  443 (HTTPS)
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw reload
```

---

## ğŸ”§ BÆ¯á»šC 3: Cáº¬P NHáº¬T Cáº¤U HÃŒNH LARAVEL

### **3.1. Cáº­p nháº­t file .env**

```bash
# VÃ o thÆ° má»¥c project
cd /var/www/domain

# Má»Ÿ file .env
nano .env
```

**Cáº­p nháº­t dÃ²ng APP_URL:**

```env
# Thay Ä‘á»•i tá»«:
APP_URL=http://103.157.204.120:8000

# ThÃ nh:
APP_URL=http://vtkt.online
# hoáº·c náº¿u cÃ³ SSL:
APP_URL=https://vtkt.online
```

**LÆ°u file:** `Ctrl + O`, Enter, `Ctrl + X`

### **3.2. Clear cache Laravel**

```bash
# VÃ o container app
docker-compose exec app bash

# Clear cÃ¡c cache
php artisan config:clear
php artisan cache:clear
php artisan route:clear
php artisan view:clear

# Cache láº¡i cho production
php artisan config:cache
php artisan route:cache
php artisan view:cache

# ThoÃ¡t container
exit
```

---

## ğŸ”§ BÆ¯á»šC 4: KIá»‚M TRA

### **4.1. Kiá»ƒm tra tá»« browser**

Má»Ÿ browser vÃ  truy cáº­p:
- **http://vtkt.online** (thay báº±ng domain cá»§a báº¡n)
- **http://www.vtkt.online**

**Káº¿t quáº£ mong Ä‘á»£i:**
- âœ… Website hiá»ƒn thá»‹ Ä‘Ãºng
- âœ… CSS/JS load Ä‘Æ°á»£c
- âœ… KhÃ´ng cÃ³ lá»—i 404

### **4.2. Kiá»ƒm tra logs náº¿u cÃ³ lá»—i**

```bash
# Xem logs Apache
sudo tail -f /var/log/apache2/vtkt.online_error.log

# Xem logs Docker
docker-compose logs -f app
```

---

## ğŸ”’ BÆ¯á»šC 5: CÃ€I Äáº¶T SSL (HTTPS) - TÃ™Y CHá»ŒN NHÆ¯NG KHUYáº¾N NGHá»Š

### **5.1. CÃ i Ä‘áº·t Certbot**

```bash
# CÃ i Ä‘áº·t Certbot
sudo apt install -y certbot python3-certbot-apache
```

### **5.2. CÃ i Ä‘áº·t SSL Certificate**

```bash
# CÃ i Ä‘áº·t SSL cho domain
sudo certbot --apache -d vtkt.online -d www.vtkt.online

# LÃ m theo hÆ°á»›ng dáº«n:
# - Nháº­p email cá»§a báº¡n
# - Chá»n Agree
# - Chá»n Redirect (tÃ¹y chá»n, khuyáº¿n nghá»‹)
```

### **5.3. Cáº­p nháº­t .env vá»›i HTTPS**

```bash
# Má»Ÿ file .env
nano /var/www/domain/.env

# Cáº­p nháº­t APP_URL
APP_URL=https://vtkt.online
```

### **5.4. Cáº­p nháº­t Virtual Host cho HTTPS**

Certbot sáº½ tá»± Ä‘á»™ng cáº­p nháº­t file cáº¥u hÃ¬nh, nhÆ°ng náº¿u cáº§n chá»‰nh sá»­a:

```bash
sudo nano /etc/apache2/sites-available/vtkt.online-le-ssl.conf
```

**Ná»™i dung máº«u:**

```apache
<VirtualHost *:443>
    ServerName vtkt.online
    ServerAlias www.vtkt.online
    
    # SSL Configuration
    SSLEngine on
    SSLCertificateFile /etc/letsencrypt/live/vtkt.online/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/vtkt.online/privkey.pem
    
    # Proxy to Docker
    ProxyPreserveHost On
    ProxyPass / http://localhost:8000/
    ProxyPassReverse / http://localhost:8000/
    
    # Logs
    ErrorLog ${APACHE_LOG_DIR}/vtkt.online_ssl_error.log
    CustomLog ${APACHE_LOG_DIR}/vtkt.online_ssl_access.log combined
</VirtualHost>
```

### **5.5. Auto-renewal SSL**

```bash
# Kiá»ƒm tra auto-renewal Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh chÆ°a
sudo certbot renew --dry-run

# Náº¿u OK, SSL sáº½ tá»± Ä‘á»™ng gia háº¡n
```

---

## ğŸ†˜ TROUBLESHOOTING

### **Lá»—i 1: Domain khÃ´ng trá» Ä‘Æ°á»£c**

**NguyÃªn nhÃ¢n:** DNS chÆ°a propagate

**Giáº£i phÃ¡p:**
```bash
# Kiá»ƒm tra DNS
nslookup vtkt.online

# Náº¿u chÆ°a trá», Ä‘á»£i thÃªm 1-2 giá»
# Hoáº·c thá»­ Ä‘á»•i DNS server:
# - Cloudflare: 1.1.1.1, 1.0.0.1
# - Google: 8.8.8.8, 8.8.4.4
```

---

### **Lá»—i 2: Website khÃ´ng truy cáº­p Ä‘Æ°á»£c qua domain**

**Kiá»ƒm tra:**

```bash
# 1. Kiá»ƒm tra Apache Ä‘ang cháº¡y
sudo systemctl status apache2

# 2. Kiá»ƒm tra Virtual Host Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t
sudo apache2ctl -S

# 3. Kiá»ƒm tra port 80 Ä‘Ã£ má»Ÿ
sudo netstat -tulpn | grep :80

# 4. Kiá»ƒm tra firewall
sudo ufw status

# 5. Kiá»ƒm tra logs
sudo tail -f /var/log/apache2/error.log
```

---

### **Lá»—i 3: CSS/JS khÃ´ng load**

**NguyÃªn nhÃ¢n:** APP_URL chÆ°a Ä‘Æ°á»£c cáº­p nháº­t

**Giáº£i phÃ¡p:**
```bash
# VÃ o container
docker-compose exec app bash

# Clear cache
php artisan config:clear
php artisan cache:clear

# Cáº­p nháº­t láº¡i .env vá»›i domain má»›i
# Sau Ä‘Ã³ cache láº¡i
php artisan config:cache

exit
```

---

### **Lá»—i 4: 502 Bad Gateway**

**NguyÃªn nhÃ¢n:** Docker container khÃ´ng cháº¡y hoáº·c port 8000 khÃ´ng accessible

**Giáº£i phÃ¡p:**
```bash
# Kiá»ƒm tra containers
docker-compose ps

# Kiá»ƒm tra port 8000
curl http://localhost:8000

# Náº¿u lá»—i, restart containers
docker-compose restart

# Kiá»ƒm tra logs
docker-compose logs app
```

---

### **Lá»—i 5: Mixed Content (HTTP/HTTPS)**

**NguyÃªn nhÃ¢n:** Website load HTTP resources trÃªn HTTPS page

**Giáº£i phÃ¡p:**
```bash
# Cáº­p nháº­t .env
APP_URL=https://vtkt.online

# Clear cache
docker-compose exec app php artisan config:clear
docker-compose exec app php artisan config:cache
```

---

## ğŸ“ CHECKLIST HOÃ€N THÃ€NH

- [ ] ÄÃ£ cáº¥u hÃ¬nh DNS A Record táº¡i nhÃ  cung cáº¥p domain
- [ ] ÄÃ£ kiá»ƒm tra DNS propagate thÃ nh cÃ´ng
- [ ] ÄÃ£ cÃ i Ä‘áº·t vÃ  cáº¥u hÃ¬nh Apache
- [ ] ÄÃ£ táº¡o Virtual Host cho domain
- [ ] ÄÃ£ kÃ­ch hoáº¡t Virtual Host
- [ ] ÄÃ£ má»Ÿ firewall port 80 vÃ  443
- [ ] ÄÃ£ cáº­p nháº­t APP_URL trong .env
- [ ] ÄÃ£ clear cache Laravel
- [ ] Website truy cáº­p Ä‘Æ°á»£c qua domain (HTTP)
- [ ] ÄÃ£ cÃ i Ä‘áº·t SSL (HTTPS) - tÃ¹y chá»n
- [ ] Website truy cáº­p Ä‘Æ°á»£c qua HTTPS - tÃ¹y chá»n

---

## ğŸ¯ Káº¾T QUáº¢ MONG Äá»¢I

Sau khi hoÃ n thÃ nh:
- âœ… Truy cáº­p website qua domain: `http://vtkt.online` hoáº·c `https://vtkt.online`
- âœ… KhÃ´ng cáº§n gÃµ port `:8000` ná»¯a
- âœ… Website hiá»ƒn thá»‹ Ä‘áº§y Ä‘á»§ CSS/JS
- âœ… Admin panel: `http://vtkt.online/admin/login`
- âœ… SSL hoáº¡t Ä‘á»™ng (náº¿u Ä‘Ã£ cÃ i)

---

## ğŸ“ CÃC Lá»†NH Há»®U ÃCH

### **Quáº£n lÃ½ Apache:**
```bash
# Restart Apache
sudo systemctl restart apache2

# Xem status
sudo systemctl status apache2

# Xem logs
sudo tail -f /var/log/apache2/error.log
```

### **Quáº£n lÃ½ DNS:**
```bash
# Kiá»ƒm tra DNS
nslookup vtkt.online
dig vtkt.online

# Flush DNS cache (Windows)
ipconfig /flushdns
```

### **Quáº£n lÃ½ Docker:**
```bash
# Restart containers
docker-compose restart

# Xem logs
docker-compose logs -f app
```

---

## âœ… Káº¾T LUáº¬N

Sau khi hoÃ n thÃ nh cÃ¡c bÆ°á»›c trÃªn, domain cá»§a báº¡n sáº½ trá» vá» VPS vÃ  website sáº½ truy cáº­p Ä‘Æ°á»£c qua domain thay vÃ¬ IP.

**LÆ°u Ã½ quan trá»ng:**
- DNS cÃ³ thá»ƒ máº¥t 1-48 giá» Ä‘á»ƒ propagate hoÃ n toÃ n
- Náº¿u sau 24 giá» váº«n khÃ´ng Ä‘Æ°á»£c, kiá»ƒm tra láº¡i cáº¥u hÃ¬nh DNS
- LuÃ´n backup trÆ°á»›c khi thay Ä‘á»•i cáº¥u hÃ¬nh
- Khuyáº¿n nghá»‹ cÃ i SSL Ä‘á»ƒ báº£o máº­t website

